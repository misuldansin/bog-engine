var e=(a,b)=>{if(!b.has(a))throw TypeError("Cannot read from private field");return b.get(a)},l=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},n=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot write to private field");b.set(a,c)},u=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot access private method");return c},aa=(a,b)=>({set G(c){n(a,b,c)},get G(){return e(a,b)}});
(function(){function a(c){if(!c.ra){c.ra=!0;var d={};d=(c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d);fetch(c.href,d)}}const b=document.createElement("link").relList;if(!(b&&b.supports&&b.supports("modulepreload"))){for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);(new MutationObserver(c=>
{for(const d of c)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)})).observe(document,{childList:!0,subtree:!0})}})();const v={C:244,B:192,oa:10,na:1,ca:42,ba:4,da:.02,fa:0,ea:1,ya:!0,xa:!1,ma:16.667,F:25};function ba(a){a=[...a];for(let b=a.length-1;b>0;b--){const c=Math.floor(Math.random()*(b+1));[a[b],a[c]]=[a[c],a[b]]}return a}
function ca(a){var b=Math.max(10,Math.min(a,80));const c=b*Math.PI/180;a=[];(a.push([{dx:0,dy:-1}]),b<50)?(a.push([{dx:1,dy:-1},{dx:-1,dy:-1}]),b=Math.round(1/Math.tan(c)),a.push([{dx:b,dy:-1},{dx:b*-1,dy:-1}])):(b=Math.round(Math.tan(c)),a.push([{dx:1,dy:-b},{dx:-1,dy:-b}]));return a}
async function da(){try{const a=await fetch("./src/data/particles.data");if(!a.ok)throw Error(`HTTP error! Status: ${a.status}`);return await a.text()}catch(a){throw console.error("Failed to read particle data from ./src/data/particles.data:",a),Error("Failed to load particle data.");}}
async function ea(){var a=await da();let b={};var c=new Set,d=null;for(var f of a.split("\n"))if(a=f.trim(),a.length!==0&&!a.startsWith("#"))if(a.startsWith("[")&&a.endsWith("]"))a=parseInt(a.slice(1,-1),10),isNaN(a)||a<10?d=null:c.has(a)?(console.warn(`[Loader] Duplicate ID found: ${a}. Ignoring.`),d=null):(c.add(a),d=a,b[a]={});else if(d!==null&&(a=a.split(":").map(h=>h.trim()),a.length===2)){const h=a[1],g=b[d];switch(a[0]){case "name":g.name=h;break;case "category":g.h=parseInt(h,10);break;case "base_color":g.R=
h;break;case "variant_color":g.$=h;break;case "is_movable":g.T=h==="true";break;case "density":g.o=parseFloat(h);break;case "max_concentration":g.ta=parseInt(h);break;case "repose_angle":g.X=parseFloat(h)}}c={};for(const h in b)d=b[h],f=parseInt(h,10),d.name===void 0||d.h===void 0||d.R===void 0||d.$===void 0||d.T===void 0||d.o===void 0?console.warn(`[Loader] Corrupted particle block found of ID: ${f}. Missing core properties.`):(a={id:f,name:d.name,H:d.R,K:d.$,D:d.T,o:d.o},d.h===1?c[f]={...a,h:1}:
d.h===2?c[f]={...a,U:d.ta,h:2}:d.h===3?c[f]={...a,h:3}:d.h===4?c[f]={...a,h:4,W:d.X,I:ca(d.X)}:d.h===5&&(c[f]={...a,h:5}));return c[0]={id:0,name:"Empty",h:0,H:"#0E0E11",K:"#0E0E11",D:!0,o:0},c}var y,z,A,C,D,fa,E,ha,ia,ja,ka;
class la{constructor(a){l(this,ha);l(this,y);l(this,z);l(this,A);l(this,C);l(this,D);l(this,fa);l(this,E);n(this,y,a);n(this,z,e(this,y).getContext("2d"));n(this,A,v.C);n(this,C,v.B);n(this,D,new Uint8ClampedArray(e(this,A)*e(this,C)*4));n(this,fa,[]);n(this,E,new Map);e(this,y).width=e(this,A);e(this,y).height=e(this,C);e(this,z).imageSmoothingEnabled=!1;e(this,z).translate(0,e(this,y).height);e(this,z).scale(1,-1)}}y=new WeakMap;z=new WeakMap;A=new WeakMap;C=new WeakMap;D=new WeakMap;fa=new WeakMap;
E=new WeakMap;ha=new WeakSet;ia=function(){var a=e(this,fa);const b=e(this,A),c=e(this,C);for(const d of a){a=(c-1-d.position.y)*b+d.position.x;let f=u(this,ha,ja).call(this,d);e(this,D)[a*4]=f[0];e(this,D)[a*4+1]=f[1];e(this,D)[a*4+2]=f[2];e(this,D)[a*4+3]=f[3]}};ja=function(a){return a.color};
ka=function(a){var b=e(this,E);if(b.size!==0)for(const [d,f]of b){var c=f[3];b=c/255;const h=Math.round(f[1]*b+a[d*4+1]*(1-b)),g=Math.round(f[2]*b+a[d*4+2]*(1-b));c=Math.min(a[d*4+3],c);a[d*4]=Math.round(f[0]*b+a[d*4]*(1-b));a[d*4+1]=h;a[d*4+2]=g;a[d*4+3]=c}};
const ma=Object.freeze({Ka:new Uint8ClampedArray([255,255,255,255]),N:new Uint8ClampedArray([0,0,0,255]),Ca:new Uint8ClampedArray([128,128,128,255]),RED:new Uint8ClampedArray([255,0,0,255]),Da:new Uint8ClampedArray([0,255,0,255]),va:new Uint8ClampedArray([0,0,255,255]),La:new Uint8ClampedArray([255,255,0,255]),wa:new Uint8ClampedArray([0,255,255,255]),Ea:new Uint8ClampedArray([255,0,255,255]),Ha:new Uint8ClampedArray([0,0,0,0]),Ga:new Uint8ClampedArray([255,255,255,128])});
function na(a){if(a==null)return ma.N;a=a.replace("#","");if(a.length===6)a+="FF";else if(a.length===3){let c="";for(var b of a)c+=b,c+=b;a=c+"FF"}else return ma.N;b=parseInt(a,16);return new Uint8ClampedArray([b>>24&255,b>>16&255,b>>8&255,b&255])}
const oa=Object.freeze({aa:[{dx:-1,dy:1},{dx:0,dy:1},{dx:1,dy:1},{dx:-1,dy:0},{dx:1,dy:0},{dx:-1,dy:-1},{dx:0,dy:-1},{dx:1,dy:-1}]}),pa=Object.freeze({Ia:{dx:-1,dy:1},pa:{dx:0,dy:1},Ja:{dx:1,dy:1},ka:{dx:-1,dy:0},Fa:{dx:1,dy:0},Aa:{dx:-1,dy:-1},za:{dx:0,dy:-1},Ba:{dx:1,dy:-1}});var F,H,qa,ra,sa;function ta(a,b){e(a,H).add(b.index);b=ua(a,b);for(const c of b)e(a,H).add(c.index)}function va(a,b,c){return b>=0&&b<a.width&&c>=0&&c<a.height?e(a,F)[c*a.width+b]:null}
function wa(a,b,c,d=!1){for(var f of c)if(f){c=ba(f);for(const h of c)if(c=h.dx,d&&Math.random()>.5&&(c=h.dx*-1),(c=va(a,b.position.x+c,b.position.y+h.dy))&&c.D&&b.o>c.o)return e(a,F)[c.index]=b,e(a,F)[b.index]=c,d={x:b.position.x,y:b.position.y},f=b.index,b.position=c.position,b.index=c.index,c.position=d,c.index=f,ta(a,b),ta(a,c),c}return null}
function xa(a,b,c){e(a,F)[b.index]=c;e(a,F)[c.index]=b;const d={x:b.position.x,y:b.position.y},f=b.index;b.position=c.position;b.index=c.index;c.position=d;c.index=f;ta(a,b);ta(a,c)}function ya(a,b,c){return va(a,b.position.x+c.dx,b.position.y+c.dy)}function ua(a,b){return oa.aa.map(c=>ya(a,b,c)).filter(c=>c!==null).filter(()=>!0)}
class za{constructor(a,b,c){l(this,qa);l(this,F);l(this,H);this.width=a;this.height=b;n(this,F,Array(a*b));n(this,H,new Set);this.la=c;u(this,qa,sa).call(this,0)}get data(){return e(this,F)}get S(){return e(this,H)}}F=new WeakMap;H=new WeakMap;qa=new WeakSet;
ra=function(a){a=this.la[a];if(!a)return null;var b=Math.round(Math.random()*5)/5;const c=na(a.H),d=na(a.K);b=new Uint8ClampedArray([c[0]+(d[0]-c[0])*b,c[1]+(d[1]-c[1])*b,c[2]+(d[2]-c[2])*b,c[3]+(d[3]-c[3])*b]);b={handle:-1,id:a.id,name:a.name,color:b,position:{x:-1,y:-1},index:0,D:a.D,o:a.o};return a.h===0?{...b,h:0}:a.h===1?{...b,h:1}:a.h===2?{...b,h:2,Ma:0,U:a.U}:a.h===3?{...b,h:3}:a.h===4?{...b,h:4,W:a.W,I:a.I}:a.h===5?{...b,h:5,node:-1}:null};
sa=function(a){const b=this.width,c=this.height;n(this,F,Array(b*c));for(let d=0;d<c;d++)for(let f=0;f<b;f++){let h=d*b+f,g=u(this,qa,ra).call(this,a);g&&(g.position.x=f,g.position.y=d,g.index=h,e(this,F)[h]=g,e(this,H).add(g.index))}};const Aa=Object.keys(pa);var Ba,Ca,Da,Ea,Fa,I,J,Ga,Ha,Ia,Ja,L,M,Ka,La,Ma,N,Na,Oa,Pa,Qa,Ra;
function Sa(a){const b=a.width;var c=a.height;const d=[],f=[],h={};for(--c;c>=0;c--)for(let q=0;q<b;q++){var g=c*b+q,k=va(a,q,c);if(!k||k.h!==2||k.h!==2)continue;const r=ya(a,k,pa.pa);var m=ya(a,k,pa.ka),p=r&&r.id===k.id;const w=m&&m.id===k.id;let x=-1;w&&(x=c*b+(q-1));let B=-1;p&&(B=(c+1)*b+q);m=r&&r.id===0;if(w||p)if(w&&!p)p=h[x],d[p].push(g),m&&(f[p].m.push(k),f[p].u.push(r)),h[g]=p;else if(!w&&p)p=h[B],d[p].push(g),m&&(f[p].m.push(k),f[p].u.push(r)),h[g]=p;else{if(p=h[B],d[p].push(g),m&&(f[p].m.push(k),
f[p].u.push(r)),h[g]=p,g=h[x],g!==p){k=f[g];for(const t of k.m)f[p].m.push(t);for(const t of k.u)f[p].u.push(t);k=d[g];for(const t of k)h[t]=p;d[g]=[];f[g]={m:[],u:[]}}}else p=f.length,d.push([g]),f.push({m:[],u:[]}),m&&(f[p].m.push(k),f[p].u.push(r)),h[g]=p}return f.filter(q=>q.m.length>30)}
class Ta{constructor(a,b,c,d){l(this,N);l(this,Ba);l(this,Ca);l(this,Da);l(this,Ea);l(this,Fa);l(this,I);l(this,J);l(this,Ga);l(this,Ha);l(this,Ia);l(this,Ja);l(this,L);l(this,M);l(this,Ka,0);l(this,La,60);l(this,Ma,f=>{if(e(this,Ga)){if(e(this,L)){var h=f-e(this,L);n(this,L,f);var g=e(this,Ca),k=e(this,I),m=e(this,Ba),p=Math.floor(g.j.x),q=Math.floor(g.j.y);if(g.v){var r=u(g,O,Ua).call(g,p,q);for(var w of r)e(m,E).set(w.index,w.value)}if(g.g||g.i)if(m=p<e(g,P)+e(g,Q)&&p>=0-e(g,Q),r=q<e(g,Va)+e(g,
Q)&&q>=0-e(g,Q),m&&r)for(m=g.g?e(g,T):0,--q,r=e(g,Q),w=-r;w<=r;w++)for(let K=-r;K<=r;K++){if(w*w+K*K>r*r)continue;const R=p+w,S=q+K;if(R>=0&&R<k.width&&S>=0&&S<k.height){var x=va(k,R,S);if(m===0||x===null||x.id===0)if(x=k,R>=0&&R<x.width&&S>=0&&S<x.height){var B=u(x,qa,ra).call(x,m);B.position.x=R;B.position.y=S;B.index=S*x.width+R;ta(x,B);e(x,F)[S*x.width+R]=B}}}g.A&&(k=g.l*e(g,Wa),k=e(g,Q)-k,k=Math.floor(k),k=Math.min(e(g,Xa),k),k=Math.max(0,k),n(g,Q,k),g.l=0);n(this,M,e(this,M)+h);for(h=0;e(this,
M)>=e(this,Ja);){k=[];for(var t of e(this,I).S)k.push(e(this,I).data[t]);aa(this,Ka).G++;e(this,Ka)>e(this,La)&&(e(this,I).S.clear(),n(this,Ka,0));m=new Uint8ClampedArray([210,55,55,180]);g=e(this,Ba);p=k;m=e(this,Da).sa?m:void 0;if(e(g,fa).push(...p),m){q=e(g,A);r=e(g,C);for(var G of p)p=(r-1-G.position.y)*q+G.position.x,e(g,E).set(p,m)}u(this,N,Na).call(this,k);this.J++;n(this,M,e(this,M)-e(this,Ja));h++;h>60&&n(this,M,0)}t=e(this,Ba);u(t,ha,ia).call(t);G=new Uint8ClampedArray(e(t,D));u(t,ha,ka).call(t,
G);G=new ImageData(G,e(t,A),e(t,C));e(t,z).putImageData(G,0,0);e(t,fa).length=0;e(t,E).clear();t=e(this,Da);e(t,Ya)&&(u(t,Za,$a).call(t,f,this),(f=e(t,U).get("fps"))&&(f.textContent=`FPS: ${e(t,ab).toFixed(2)}`),(f=e(t,U).get("tps"))&&(f.textContent=`TPS: ${e(t,bb).toFixed(2)}`))}else n(this,L,f);n(this,Ha,requestAnimationFrame(e(this,Ma)))}});n(this,Ba,b);n(this,Ca,c);n(this,Da,d);n(this,Ea,v.C);n(this,Fa,v.B);n(this,I,new za(e(this,Ea),e(this,Fa),a));n(this,J,new Set);n(this,Ga,!1);n(this,Ha,null);
n(this,Ia,v.ma);n(this,Ja,v.F);n(this,L,null);n(this,M,0);this.J=0}start(){e(this,Ga)||(n(this,Ga,!0),e(this,Ma).call(this,0))}}Ba=new WeakMap;Ca=new WeakMap;Da=new WeakMap;Ea=new WeakMap;Fa=new WeakMap;I=new WeakMap;J=new WeakMap;Ga=new WeakMap;Ha=new WeakMap;Ia=new WeakMap;Ja=new WeakMap;L=new WeakMap;M=new WeakMap;Ka=new WeakMap;La=new WeakMap;Ma=new WeakMap;N=new WeakSet;
Na=function(a){e(this,J).clear();a=ba(a);a.sort((b,c)=>b.position.y-c.position.y);for(const b of a)if(b&&!e(this,J).has(b.index))switch(b.h){case 2:u(this,N,Oa).call(this,b);break;case 3:u(this,N,Pa).call(this,b);break;case 4:u(this,N,Qa).call(this,b)}a=Sa(e(this,I));u(this,N,Ra).call(this,a)};Oa=function(a){const b=wa(e(this,I),a,[[{dx:0,dy:-1}],[{dx:-1,dy:-1},{dx:1,dy:-1}],[{dx:-1,dy:0},{dx:1,dy:0}]],!1);b&&(e(this,J).add(a.index),e(this,J).add(b.index))};
Pa=function(a){var b=[[pa[Aa[Math.floor(Math.random()*Aa.length)]]]];(b=wa(e(this,I),a,b,!1))&&(e(this,J).add(a.index),e(this,J).add(b.index))};Qa=function(a){var b=a.I;(b=wa(e(this,I),a,b,!0))&&(e(this,J).add(a.index),e(this,J).add(b.index))};
Ra=function(a){for(const b of a){a=b.m.sort((g,k)=>k.position.y-g.position.y);const c=b.u.sort((g,k)=>g.position.y-k.position.y),d=a.length;let f=0;const h=d/4;for(let g=0;g<d;g++){const k=a[g],m=c[g];if(Math.sqrt(k.position.x*m.position.x+k.position.y*m.position.y),k.position.y>m.position.y&&(xa(e(this,I),k,m),e(this,J).add(k.index),e(this,J).add(m.index),f++,f>=h))break}}};var cb,P,Va,db,V,eb,Wa,Xa,T,W,Q,fb,gb,X,Y,Z,O,Ua,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb;
class xb{constructor(a,b,c,d){l(this,O);l(this,cb);l(this,P);l(this,Va);l(this,db);l(this,V);l(this,eb);l(this,Wa);l(this,Xa);l(this,T);l(this,W);l(this,Q);l(this,fb);l(this,gb);l(this,X);l(this,Y);l(this,Z);l(this,nb,f=>{n(this,Z,f.pointerId);f.button===0?(this.g=!0,this.i=!1):f.button===2?(this.i=!0,this.g=!1):(this.g=!1,this.i=!1);try{e(this,V).setPointerCapture(f.pointerId)}catch{}const h=e(this,V).getBoundingClientRect(),g=e(this,P)/h.width,k=e(this,Va)/h.height;this.j.x=(f.clientX-h.left)*g;
this.j.y=e(this,V).height-(f.clientY-h.top)*k});l(this,ob,f=>{if(e(this,Z)===f.pointerId){n(this,Z,null);try{e(this,V).releasePointerCapture(f.pointerId)}catch{}}this.i=this.g=!1});l(this,pb,f=>{var h=e(this,V).getBoundingClientRect();const g=e(this,P)/h.width,k=e(this,V).height/h.height;if(this.j.x=(f.clientX-h.left)*g,this.j.y=e(this,V).height-(f.clientY-h.top)*k,typeof f.buttons=="number")h=(f.buttons&2)===2,this.g=(f.buttons&1)===1,this.i=h});l(this,qb,f=>{if(this.g=!1,this.i=!1,e(this,Z)===f.pointerId){try{e(this,
V).releasePointerCapture(f.pointerId)}catch{}n(this,Z,null)}});l(this,rb,()=>{this.i=this.g=!1;n(this,Z,null)});l(this,sb,()=>{document.hidden&&(this.g=!1,this.i=!1,n(this,Z,null))});l(this,tb,f=>{f.preventDefault();this.A=!0;this.l=f.deltaY});l(this,ub,f=>{f.preventDefault()});l(this,vb,()=>{this.v=!0});l(this,wb,()=>{this.v=!1});n(this,cb,d);n(this,P,v.C);n(this,Va,v.B);n(this,db,b);n(this,V,c);n(this,eb,a);n(this,Wa,v.da);n(this,Xa,v.ca);n(this,T,v.oa);n(this,W,v.na);n(this,Q,v.ba);n(this,fb,v.fa);
n(this,gb,v.ea);n(this,X,null);n(this,Y,null);n(this,Z,null);this.i=this.g=!1;this.v=!0;this.A=!1;this.l=0;this.j={x:0,y:0};a=document.getElementById("particle-category-bar");if(!a)throw Error("DOM element of id 'particle-category-bar' does not exist.");u(this,O,jb).call(this,a);a=document.getElementById("particle-button-container");if(!a)throw Error("DOM element of id 'particle-button-container' does not exist.");u(this,O,lb).call(this,a);u(this,O,mb).call(this);e(this,Y)&&u(this,O,hb).call(this,
e(this,Y))}}cb=new WeakMap;P=new WeakMap;Va=new WeakMap;db=new WeakMap;V=new WeakMap;eb=new WeakMap;Wa=new WeakMap;Xa=new WeakMap;T=new WeakMap;W=new WeakMap;Q=new WeakMap;fb=new WeakMap;gb=new WeakMap;X=new WeakMap;Y=new WeakMap;Z=new WeakMap;O=new WeakSet;
Ua=function(a,b){var c=e(this,Q);const d=[],f=e(this,P),h=e(this,Va),g=[-1,1],k=(q,r)=>{for(const w of g)for(const x of g){const B=a+q*x,t=b+r*w,G=a+r*x,K=b+q*w;B>=0&&B<f&&t>=0&&t<h&&d.push({index:(h-t)*f+B,value:new Uint8ClampedArray([227,227,227,180])});G>=0&&G<f&&K>=0&&K<h&&d.push({index:(h-K)*f+G,value:new Uint8ClampedArray([227,227,227,180])})}};let m=c,p=0;c-=c;for(k(m,p);p<m;)p++,c<0?c+=2*p+1:(m--,c+=2*(p-m)+1),k(m,p);return d};
hb=function(a){e(this,Y)&&e(this,Y).classList.remove("selected");a.classList.add("selected");n(this,Y,a);n(this,W,parseInt(a.dataset.qa)||1);let b=null;e(this,eb)[e(this,T)]!==void 0&&(a=e(this,eb)[e(this,T)])&&a.h===e(this,W)&&e(this,X)&&(b=e(this,X));document.querySelectorAll(".particle-button").forEach(c=>{const d=c.dataset.h;d&&parseInt(d)===e(this,W)?(c.style.display="",b||(b=c)):c.style.display="none"});u(this,O,ib).call(this,b)};
ib=function(a){a&&(e(this,X)&&e(this,X).classList.remove("selected"),a.classList.add("selected"),n(this,X,a),n(this,T,parseInt(a.dataset.ua)||0))};
jb=function(a){a.innerHTML="";var b=u(this,O,kb).call(this,1,"Solids","./assets/icons/solid.svg");a.appendChild(b);e(this,W)==1&&n(this,Y,b);b=u(this,O,kb).call(this,2,"Liquids","./assets/icons/liquid.svg");a.appendChild(b);e(this,W)==2&&n(this,Y,b);b=u(this,O,kb).call(this,3,"Gases","./assets/icons/gas.svg");a.appendChild(b);e(this,W)==3&&n(this,Y,b);b=u(this,O,kb).call(this,4,"Sands","./assets/icons/sand.svg");a.appendChild(b);e(this,W)==4&&n(this,Y,b);let c=u(this,O,kb).call(this,5,"Electronics",
"./assets/icons/electronics.svg");a.appendChild(c);e(this,W)==5&&n(this,Y,c);e(this,Y)||n(this,Y,b)};kb=function(a,b,c){const d=document.createElement("button");d.className="category-button";const f=document.createElement("img");return f.src=c,f.alt=b,f.classList.add("category-icon"),d.dataset.qa=a.toString(),d.appendChild(f),d};
lb=function(a){a.innerHTML="";for(const c in e(this,eb)){const d=e(this,eb)[c];if(!d)continue;const f=document.createElement("button");f.className="particle-button";f.textContent=d.name;const h=d.H,g=d.K;var b=na(h);b=.299*b[0]+.587*b[1]+.114*b[2]>210?"#323238":"#FFFFFFFF";const k=na(b);f.style.setProperty("--particle-button-base-color",h);f.style.setProperty("--particle-button-variant-color",g);f.style.color=b;f.style.textShadow=`1px 1px 2px rgba(${k[0]}, ${k[1]}, ${k[2]}, 0.6)`;f.dataset.ua=d.id.toString();
f.dataset.h=d.h.toString();a.appendChild(f);d.id===e(this,T)&&n(this,X,f)}};
mb=function(){const a=e(this,V),b=document.getElementById("particle-category-bar"),c=document.getElementById("particle-button-container");if(!b||!c)throw Error("Cannot find category bar and/ or button container");a.addEventListener("pointerdown",e(this,nb));a.addEventListener("pointermove",e(this,pb));a.addEventListener("pointerup",e(this,ob));a.addEventListener("pointercancel",e(this,qb));a.addEventListener("lostpointercapture",e(this,qb));a.addEventListener("pointerenter",e(this,vb));a.addEventListener("pointerleave",
e(this,wb));a.addEventListener("wheel",e(this,tb),{passive:!1});e(this,db).addEventListener("contextmenu",e(this,ub));window.addEventListener("pointerup",e(this,rb));window.addEventListener("mouseup",e(this,rb));document.addEventListener("visibilitychange",e(this,sb));b.addEventListener("click",d=>{d.target&&(d=d.target.closest(".category-button"))&&d&&u(this,O,hb).call(this,d)});c.addEventListener("click",d=>{d.target&&(d=d.target.closest(".particle-button"))&&u(this,O,ib).call(this,d)})};nb=new WeakMap;
ob=new WeakMap;pb=new WeakMap;qb=new WeakMap;rb=new WeakMap;sb=new WeakMap;tb=new WeakMap;ub=new WeakMap;vb=new WeakMap;wb=new WeakMap;var Ya,yb,U,zb,ab,bb,Ab,Za,$a,Bb;class Cb{constructor(a){l(this,Za);l(this,Ya);l(this,yb);l(this,U);l(this,zb);l(this,ab);l(this,bb);l(this,Ab);n(this,Ya,!1);n(this,yb,!1);n(this,U,new Map);n(this,zb,0);n(this,ab,0);n(this,bb,0);n(this,Ab,0);u(this,Za,Bb).call(this,a)}get sa(){return e(this,yb)}}Ya=new WeakMap;yb=new WeakMap;U=new WeakMap;zb=new WeakMap;ab=new WeakMap;
bb=new WeakMap;Ab=new WeakMap;Za=new WeakSet;$a=function(a,b){const c=a-e(this,Ab);c>=1E3&&(n(this,ab,e(this,zb)*1E3/c),n(this,bb,b.J*1E3/c),n(this,zb,0),b.J=0,n(this,Ab,a));aa(this,zb).G++};
Bb=function(a){var b=document.createElement("div");b.classList.add("debug-container");a.appendChild(b);e(this,U).set("debug-container",b);a=document.createElement("div");a.classList.add("debug-info-container");b.appendChild(a);e(this,U).set("info-container",a);b=document.createElement("div");b.classList.add("debug-info");a.appendChild(b);e(this,U).set("fps",b);b=document.createElement("div");b.classList.add("debug-info");a.appendChild(b);e(this,U).set("tps",b)};
function Db(a){var b=document.createElement("div");b.classList.add("ui-window");a.ja.appendChild(b);a.g=b;a.g.style.width=`${a.P.x}px`;a.g.style.height=`${a.P.y}px`;a.g.style.maxWidth=`${a.Y.x}px`;a.g.style.maxHeight=`${a.Y.y}px`;b=document.createElement("div");b.classList.add("ui-window__titlebar");a.g.appendChild(b);a.j=b;var c=document.createElement("span");c.classList.add("ui-window__title");c.textContent="New Window";b.appendChild(c);b=document.createElement("div");b.classList.add("ui-window__controls");
a.j.appendChild(b);c=document.createElement("button");c.classList.add("ui-window__title-button");var d=document.createElement("img");d.src="./assets/icons/settings.svg";c.appendChild(d);b.appendChild(c);c=document.createElement("button");c.classList.add("ui-window__title-button");d=document.createElement("img");d.src="./assets/icons/close.svg";c.appendChild(d);b.appendChild(c);a.V=c;b=document.createElement("div");b.classList.add("ui-window__content");a.g.appendChild(b);a.i=b;a.g.style.left="80px";
a.g.style.top="80px"}function Eb(a,b){const c=document.createElement("h4");c.classList.add("ui-section");c.textContent=b;a.i.appendChild(c)}function Fb(a){const b=document.createElement("div");b.classList.add("ui-window__divider");a.i.appendChild(b)}
function Gb(a,b,c,d,f){b+=":";const h=document.createElement("div");h.classList.add("flex-row");const g=document.createElement("label");g.textContent=b;h.appendChild(g);const k=document.createElement("input");k.type="range";k.id=c+"-range";k.min=d.x.toString();k.max=d.y.toString();k.value=f.toString();d.y-d.x<2&&d.y>d.x&&(k.step=(.01).toString());h.appendChild(k);const m=document.createElement("input");m.style.minWidth="40px";m.type="number";m.id=c+"-number";m.min=d.x.toString();m.max=d.y.toString();
m.value=f.toString();k.oninput=()=>m.value=k.value;m.onchange=()=>{const p=Math.max(d.x,Math.min(d.y,parseInt(m.value))).toString();k.value=p;m.value=p};h.appendChild(m);a.i.appendChild(h)}function Hb(a,b,c,d){const f=document.createElement("button");f.classList.add("ui-window__content__Button");f.textContent=b;f.id=c;d&&(f.style.backgroundColor=d);a.i.appendChild(f)}
function Ib(a){var b=["Fastest","High Quality","Wireframe","Debug"];const c=document.createElement("div");c.classList.add("flex-row");var d=document.createElement("label");d.textContent="Render Mode:";c.appendChild(d);d=document.createElement("div");d.classList.add("custom-dropdown-container");const f=document.createElement("div");f.classList.add("dropdown-button");f.innerHTML=`
          <span id="${"render-mode"}-display">${b[0]}</span>
      `;d.appendChild(f);const h=document.createElement("ul");h.classList.add("dropdown-list");h.id="render-mode-list";d.appendChild(h);let g=0,k=[];b.forEach((m,p)=>{const q=document.createElement("li");q.style.marginBottom="0px";q.classList.add("dropdown-item");q.textContent=m;q.dataset.value=m.toLowerCase().replace(/\s/g,"-");q.dataset.index=p.toString();p===g&&q.classList.add("is-selected");q.addEventListener("click",r=>{r.stopPropagation();k[g].classList.remove("is-selected");g=p;q.classList.add("is-selected");
document.getElementById("render-mode-display").textContent=m;h.classList.remove("is-open")});h.appendChild(q);k.push(q)});f.addEventListener("click",m=>{if(m.stopPropagation(),document.querySelectorAll(".dropdown-list.is-open").forEach(p=>{p!==h&&p.classList.remove("is-open")}),h.classList.toggle("is-open")){m=Jb;const p=g*Kb;h.style.transform=`translateY(${m-p-m-6}px)`;h.style.top="0px";h.scrollTop=p}});c.appendChild(d);a.i.appendChild(c)}
function Lb(a){const b=document.createElement("div");b.classList.add("flex-row");var c=document.createElement("label");c.textContent="Smooth:";b.appendChild(c);c=document.createElement("div");c.classList.add("toggle-container");const d=document.createElement("div");d.classList.add("toggle-switch");d.id="brush-smooth-switch";d.innerHTML='\n          <span class="toggle-indicator indicator-o">O</span> \n          <span class="toggle-indicator indicator-i">I</span> \n          <div class="toggle-slider"></div>\n      ';
d.addEventListener("click",()=>{d.classList.toggle("is-on")});c.appendChild(d);b.appendChild(c);a.i.appendChild(b)}
const Nb=class{constructor(a){var b={x:400,y:600},c={x:400,y:600};this.A=()=>{Mb++;this.g.style.zIndex=Mb.toString()};this.Z=d=>{if(d.stopPropagation(),this.A(),d.button===0){this.j.setPointerCapture(d.pointerId);const f=this.g.getBoundingClientRect();this.v.x=d.clientX-f.left;this.v.y=d.clientY-f.top;this.l=!0}else this.l=!1};this.M=d=>{this.l&&(this.j.releasePointerCapture(d.pointerId),this.l=!1)};this.L=d=>{if(this.l){const f=Math.max(0,Math.min(d.clientY-this.v.y,window.innerHeight-this.g.offsetHeight));
this.g.style.left=`${Math.max(0,Math.min(d.clientX-this.v.x,window.innerWidth-this.g.offsetWidth))}px`;this.g.style.top=`${f}px`}};this.ha=()=>{window.removeEventListener("resize",this.O);this.j.removeEventListener("pointerdown",this.Z);this.j.removeEventListener("pointermove",this.L);this.j.removeEventListener("pointerup",this.M);this.g.removeEventListener("mousedown",this.A);this.g&&this.g.parentElement&&this.g.parentElement.removeChild(this.g)};this.O=()=>{const d=Math.max(0,window.innerWidth-
this.g.offsetWidth),f=Math.max(0,window.innerHeight-this.g.offsetHeight),h=this.g.offsetLeft,g=this.g.offsetTop;let k=h,m=g;h>d?k=d:h<0&&(k=0);g>f?m=f:g<0&&(m=0);(k!==h||m!==g)&&(this.g.style.left=`${k}px`,this.g.style.top=`${m}px`)};this.ia=d=>{d.stopPropagation()};this.ga=d=>{document.querySelectorAll(".dropdown-list.is-open").forEach(f=>{const h=f.closest(".custom-dropdown-container");h&&!h.contains(d.target)&&f.classList.remove("is-open")})};this.ja=a;b.x=Math.max(40,Math.min(b.x,c.x));b.y=Math.max(40,
Math.min(b.y,c.y));this.P=b;this.Y=c;this.l=!1;this.v={x:0,y:0};Db(this);this.g.addEventListener("mousedown",this.A);this.j.addEventListener("pointerdown",this.Z);this.j.addEventListener("pointermove",this.L);this.j.addEventListener("pointerup",this.M);this.V.addEventListener("click",this.ha);this.V.addEventListener("pointerdown",this.ia);window.addEventListener("resize",this.O);this.A();document.addEventListener("click",this.ga)}};var Mb,Kb,Jb;Mb=100;Jb=Kb=30;
(async function(){try{v.C=Math.max(40,Math.min(400,v.C));v.B=Math.max(40,Math.min(400,v.B));v.F=Math.max(4,Math.min(1E3,v.F));Object.freeze(v);var a=document.getElementById("main-canvas");if(!(a instanceof HTMLCanvasElement))throw Error("HTML element 'main-canvas' does not exist.");const b=document.getElementById("main-panel");if(!(b instanceof HTMLDivElement))throw Error("HTML element 'main-panel' does not exist.");const c=new la(a),d=await ea(),f=new xb(d,b,a,c),h=new Cb(b);n(h,Ya,!0);(new Ta(d,
c,f,h)).start();console.log(d);const g=new Nb(b),k=document.createElement("h2");k.classList.add("ui-title");k.textContent="Particle Emitter Controls";g.i.appendChild(k);const m=document.createElement("img");m.classList.add("ui-image");m.src="assets/preview_image.jpg";m.alt="Preview Image";m.width=300;m.height=100;g.i.appendChild(m);const p=document.createElement("p");p.classList.add("ui-text");p.textContent="Status: Core System Active";p.style.color="#4cae50";g.i.appendChild(p);Fb(g);Eb(g,"Emitter");
const q=document.createElement("div");q.classList.add("flex-row","ui-text-input-container");const r=document.createElement("label");r.textContent="Name:";r.htmlFor="emitter-name";q.appendChild(r);const w=document.createElement("input");w.type="text";w.id="emitter-name";w.placeholder="Enter emitor name...";w.value="";q.appendChild(w);g.i.appendChild(q);Fb(g);Eb(g,"Brush Parameters");Gb(g,"Brush Size","brush-size",{x:1,y:100},20);Gb(g,"Opacity","opacity-val",{x:0,y:1},.7);Lb(g);Ib(g);Fb(g);Eb(g,"Particle Type");
for(a=1;a<=3;a++)Hb(g,`Particle Type ${a}`,`particle-${a}`);Fb(g);Hb(g,"Start Simulation","start-sim","#5a6cd4ff");Hb(g,"Save Preset","save-preset")}catch(b){console.error("ERROR: Failed to initialize engine due to data loading failure.",b)}})();

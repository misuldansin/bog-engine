var h=(a,b)=>{if(!b.has(a))throw TypeError("Cannot read from private field");return b.get(a)},m=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},q=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot write to private field");b.set(a,c)},u=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot access private method");return c},aa=(a,b)=>({set X(c){q(a,b,c)},get X(){return h(a,b)}});
(function(){function a(c){if(!c.Ca){c.Ca=!0;var d={};d=(c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d);fetch(c.href,d)}}const b=document.createElement("link").relList;if(!(b&&b.supports&&b.supports("modulepreload"))){for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);(new MutationObserver(c=>
{for(const d of c)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)})).observe(document,{childList:!0,subtree:!0})}})();const z={J:342,I:192,Aa:10,za:1,na:42,ma:4,oa:.02,Ia:0,Ha:1,La:!0,Ka:!1,xa:16.667,W:25};function ba(a){a=[...a];for(let b=a.length-1;b>0;b--){const c=Math.floor(Math.random()*(b+1));[a[b],a[c]]=[a[c],a[b]]}return a}
function ca(a){var b=Math.max(10,Math.min(a,80));const c=b*Math.PI/180;a=[];(a.push([{dx:0,dy:-1}]),b<50)?(a.push([{dx:1,dy:-1},{dx:-1,dy:-1}]),b=Math.round(1/Math.tan(c)),a.push([{dx:b,dy:-1},{dx:b*-1,dy:-1}])):(b=Math.round(Math.tan(c)),a.push([{dx:1,dy:-b},{dx:-1,dy:-b}]));return a}
async function da(){try{const a=await fetch("./src/data/particles.data");if(!a.ok)throw Error(`HTTP error! Status: ${a.status}`);return await a.text()}catch(a){throw console.error("Failed to read particle data from ./src/data/particles.data:",a),Error("Failed to load particle data.");}}
async function ea(){var a=await da();let b={};var c=new Set,d=null;for(var f of a.split("\n"))if(a=f.trim(),a.length!==0&&!a.startsWith("#"))if(a.startsWith("[")&&a.endsWith("]"))a=parseInt(a.slice(1,-1),10),isNaN(a)||a<10?d=null:c.has(a)?(console.warn(`[Loader] Duplicate ID found: ${a}. Ignoring.`),d=null):(c.add(a),d=a,b[a]={});else if(d!==null&&(a=a.split(":").map(g=>g.trim()),a.length===2)){const g=a[1],e=b[d];switch(a[0]){case "name":e.name=g;break;case "category":e.h=parseInt(g,10);break;case "base_color":e.ea=
g;break;case "variant_color":e.ka=g;break;case "is_movable":e.ga=g==="true";break;case "density":e.D=parseFloat(g);break;case "max_concentration":e.Ea=parseInt(g);break;case "repose_angle":e.ja=parseFloat(g)}}c={};for(const g in b)d=b[g],f=parseInt(g,10),d.name===void 0||d.h===void 0||d.ea===void 0||d.ka===void 0||d.ga===void 0||d.D===void 0?console.warn(`[Loader] Corrupted particle block found of ID: ${f}. Missing core properties.`):(a={id:f,name:d.name,$:d.ea,ca:d.ka,U:d.ga,D:d.D},d.h===1?c[f]=
{...a,h:1}:d.h===2?c[f]={...a,ha:d.Ea,h:2}:d.h===3?c[f]={...a,h:3}:d.h===4?c[f]={...a,h:4,ia:d.ja,aa:ca(d.ja)}:d.h===5&&(c[f]={...a,h:5}));return c[0]={id:0,name:"Empty",h:0,$:"#0E0E11",ca:"#0E0E11",U:!0,D:0},c}var A,fa,ha,ia;
class ja{constructor(a){m(this,A);this.g=a;this.i=this.g.getContext("2d");this.R=z.J;this.P=z.I;this.O=new Uint8ClampedArray(this.R*this.P*4);this.Y=[];this.j=[];this.Z=[];this.g.width=this.R;this.g.height=this.P;this.i.imageSmoothingEnabled=!1;this.i.translate(0,this.g.height);this.i.scale(1,-1)}}A=new WeakSet;
fa=function(){var a=this.Y;const b=this.R,c=this.P;for(const d of a){a=(c-1-d.position.y)*b+d.position.x;let f=u(this,A,ha).call(this,d);this.O[a*4]=f[0];this.O[a*4+1]=f[1];this.O[a*4+2]=f[2];this.O[a*4+3]=f[3]}};ha=function(a){return a.color};ia=function(a,b){for(const {index:d,value:f}of b){var c=f[3];b=c/255;const g=Math.round(f[1]*b+a[d*4+1]*(1-b)),e=Math.round(f[2]*b+a[d*4+2]*(1-b));c=Math.min(a[d*4+3],c);a[d*4]=Math.round(f[0]*b+a[d*4]*(1-b));a[d*4+1]=g;a[d*4+2]=e;a[d*4+3]=c}};
const ka=Object.freeze({Xa:new Uint8ClampedArray([255,255,255,255]),da:new Uint8ClampedArray([0,0,0,255]),Pa:new Uint8ClampedArray([128,128,128,255]),RED:new Uint8ClampedArray([255,0,0,255]),Qa:new Uint8ClampedArray([0,255,0,255]),Ga:new Uint8ClampedArray([0,0,255,255]),Ya:new Uint8ClampedArray([255,255,0,255]),Ja:new Uint8ClampedArray([0,255,255,255]),Ra:new Uint8ClampedArray([255,0,255,255]),Ua:new Uint8ClampedArray([0,0,0,0]),Ta:new Uint8ClampedArray([255,255,255,128])});
function B(a){if(a==null)return ka.da;a=a.replace("#","");if(a.length===6)a+="FF";else if(a.length===3){let c="";for(var b of a)c+=b,c+=b;a=c+"FF"}else return ka.da;b=parseInt(a,16);return new Uint8ClampedArray([b>>24&255,b>>16&255,b>>8&255,b&255])}function la(a){return.299*a[0]+.587*a[1]+.114*a[2]}
const ma=Object.freeze({la:[{dx:-1,dy:1},{dx:0,dy:1},{dx:1,dy:1},{dx:-1,dy:0},{dx:1,dy:0},{dx:-1,dy:-1},{dx:0,dy:-1},{dx:1,dy:-1}]}),na=Object.freeze({Va:{dx:-1,dy:1},Ba:{dx:0,dy:1},Wa:{dx:1,dy:1},qa:{dx:-1,dy:0},Sa:{dx:1,dy:0},Na:{dx:-1,dy:-1},Ma:{dx:0,dy:-1},Oa:{dx:1,dy:-1}});var C,E,F,oa,pa;function G(a,b){h(a,E).add(b.index);b=qa(a,b);for(const c of b)h(a,E).add(c.index)}function ra(a,b,c){return b>=0&&b<a.width&&c>=0&&c<a.height?h(a,C)[c*a.width+b]:null}
function sa(a,b,c,d=!1){for(var f of c)if(f){c=ba(f);for(const g of c)if(c=g.dx,d&&Math.random()>.5&&(c=g.dx*-1),(c=ra(a,b.position.x+c,b.position.y+g.dy))&&c.U&&b.D>c.D)return h(a,C)[c.index]=b,h(a,C)[b.index]=c,d={x:b.position.x,y:b.position.y},f=b.index,b.position=c.position,b.index=c.index,c.position=d,c.index=f,G(a,b),G(a,c),c}return null}
function ta(a,b,c){h(a,C)[b.index]=c;h(a,C)[c.index]=b;const d={x:b.position.x,y:b.position.y},f=b.index;b.position=c.position;b.index=c.index;c.position=d;c.index=f;G(a,b);G(a,c)}function ua(a,b,c){return ra(a,b.position.x+c.dx,b.position.y+c.dy)}function qa(a,b){return ma.la.map(c=>ua(a,b,c)).filter(c=>c!==null).filter(()=>!0)}
class va{constructor(a,b,c){m(this,F);m(this,C);m(this,E);this.width=a;this.height=b;q(this,C,Array(a*b));q(this,E,new Set);this.va=c;u(this,F,pa).call(this,0)}get data(){return h(this,C)}get fa(){return h(this,E)}}C=new WeakMap;E=new WeakMap;F=new WeakSet;
oa=function(a){a=this.va[a];if(!a)return null;var b=Math.round(Math.random()*5)/5;const c=B(a.$),d=B(a.ca);b=new Uint8ClampedArray([c[0]+(d[0]-c[0])*b,c[1]+(d[1]-c[1])*b,c[2]+(d[2]-c[2])*b,c[3]+(d[3]-c[3])*b]);b={handle:-1,id:a.id,name:a.name,color:b,position:{x:-1,y:-1},index:0,U:a.U,D:a.D};return a.h===0?{...b,h:0}:a.h===1?{...b,h:1}:a.h===2?{...b,h:2,Za:0,ha:a.ha}:a.h===3?{...b,h:3}:a.h===4?{...b,h:4,ia:a.ia,aa:a.aa}:a.h===5?{...b,h:5,node:-1}:null};
pa=function(a){const b=this.width,c=this.height;q(this,C,Array(b*c));for(let d=0;d<c;d++)for(let f=0;f<b;f++){let g=d*b+f,e=u(this,F,oa).call(this,a);e&&(e.position.x=f,e.position.y=d,e.index=g,h(this,C)[g]=e,h(this,E).add(e.index))}};const wa=Object.keys(na);var H,xa,I,ya,za,J,K,L,Aa,Ba,M,N,O,P,Ca,Da,Q,Ea,Fa,Ga,Ha,Ia;
function Ja(a){const b=a.width;var c=a.height;const d=[],f=[],g={};for(--c;c>=0;c--)for(let t=0;t<b;t++){var e=c*b+t,k=ra(a,t,c);if(!k||k.h!==2||k.h!==2)continue;const p=ua(a,k,na.Ba);var n=ua(a,k,na.qa),l=p&&p.id===k.id;const w=n&&n.id===k.id;let x=-1;w&&(x=c*b+(t-1));let v=-1;l&&(v=(c+1)*b+t);n=p&&p.id===0;if(w||l)if(w&&!l)l=g[x],d[l].push(e),n&&(f[l].v.push(k),f[l].F.push(p)),g[e]=l;else if(!w&&l)l=g[v],d[l].push(e),n&&(f[l].v.push(k),f[l].F.push(p)),g[e]=l;else{if(l=g[v],d[l].push(e),n&&(f[l].v.push(k),
f[l].F.push(p)),g[e]=l,e=g[x],e!==l){k=f[e];for(const y of k.v)f[l].v.push(y);for(const y of k.F)f[l].F.push(y);k=d[e];for(const y of k)g[y]=l;d[e]=[];f[e]={v:[],F:[]}}}else l=f.length,d.push([e]),f.push({v:[],F:[]}),n&&(f[l].v.push(k),f[l].F.push(p)),g[e]=l}return f.filter(t=>t.v.length>30)}
class Ka{constructor(a,b,c,d){m(this,Q);m(this,H);m(this,xa);m(this,I);m(this,ya);m(this,za);m(this,J);m(this,K);m(this,L);m(this,Aa);m(this,Ba);m(this,M);m(this,N);m(this,O);m(this,P,0);m(this,Ca,60);m(this,Da,f=>{if(h(this,L)){if(h(this,N)){var g=f-h(this,N);q(this,N,f);var e=h(this,xa),k=h(this,J),n=h(this,H),l=Math.floor(e.o.x),t=Math.floor(e.o.y);if(e.H){var p=La(e,l,t);n.Z=p}if(e.g||e.j)if(n=t<e.C+e.l&&t>=0-e.l,l<e.B+e.l&&l>=0-e.l&&n){--t;n=e.l;p=e.g?e.A:0;for(let T=-n;T<=n;T++)for(let U=-n;U<=
n;U++)if(!(T*T+U*U>n*n)){var w=l+T,x=t+U;if(w>=0&&w<k.width&&x>=0&&x<k.height){var v=ra(k,w,x);if(p===0||v===null||v.id===0){v=k;var y=p;w>=0&&w<v.width&&x>=0&&x<v.height&&(y=u(v,F,oa).call(v,y),y.position.x=w,y.position.y=x,y.index=x*v.width+w,G(v,y),h(v,C)[x*v.width+w]=y)}}}}e.T&&(k=e.l-e.G*e.sa,k=Math.floor(k),k=Math.min(e.ta,k),k=Math.max(0,k),e.l=k,e.G=0);q(this,O,h(this,O)+g);for(g=0;h(this,O)>=h(this,M);){l=[];for(var r of h(this,J).fa)l.push(h(this,J).data[r]);aa(this,P).X++;h(this,P)>h(this,
Ca)&&(h(this,J).fa.clear(),q(this,P,0));t=new Uint8ClampedArray([210,55,55,180]);e=h(this,H);k=l;t=h(this,I).Da?t:void 0;if(e.Y.push(...k),t){n=e.R;p=e.P;for(var D of k)e.j.push({index:(p-1-D.position.y)*n+D.position.x,value:t})}u(this,Q,Ea).call(this,l);this.ba++;q(this,O,h(this,O)-h(this,M));g++;g>60&&q(this,O,0)}r=h(this,H);u(r,A,fa).call(r);D=new Uint8ClampedArray(r.O);u(r,A,ia).call(r,D,r.j);u(r,A,ia).call(r,D,r.Z);D=new ImageData(D,r.R,r.P);r.i.putImageData(D,0,0);r.Y.length=0;r.j=[];r.Z=[];
r=h(this,I);h(r,R)&&(u(r,Ma,Na).call(r,f,this),(f=h(r,S).get("fps"))&&(f.textContent=`FPS: ${h(r,V).toFixed(2)}`),(f=h(r,S).get("tps"))&&(f.textContent=`TPS: ${h(r,W).toFixed(2)}`))}else q(this,N,f);q(this,Aa,requestAnimationFrame(h(this,Da)))}});q(this,H,b);q(this,xa,c);q(this,I,d);q(this,ya,z.J);q(this,za,z.I);q(this,J,new va(h(this,ya),h(this,za),a));q(this,K,new Set);q(this,L,!1);q(this,Aa,null);q(this,Ba,z.xa);q(this,M,z.W);q(this,N,null);q(this,O,0);this.ba=0}start(){h(this,L)||(q(this,L,!0),
h(this,Da).call(this,0))}}H=new WeakMap;xa=new WeakMap;I=new WeakMap;ya=new WeakMap;za=new WeakMap;J=new WeakMap;K=new WeakMap;L=new WeakMap;Aa=new WeakMap;Ba=new WeakMap;M=new WeakMap;N=new WeakMap;O=new WeakMap;P=new WeakMap;Ca=new WeakMap;Da=new WeakMap;Q=new WeakSet;
Ea=function(a){h(this,K).clear();a=ba(a);a.sort((b,c)=>b.position.y-c.position.y);for(const b of a)if(b&&!h(this,K).has(b.index))switch(b.h){case 2:u(this,Q,Fa).call(this,b);break;case 3:u(this,Q,Ga).call(this,b);break;case 4:u(this,Q,Ha).call(this,b)}a=Ja(h(this,J));u(this,Q,Ia).call(this,a)};Fa=function(a){const b=sa(h(this,J),a,[[{dx:0,dy:-1}],[{dx:-1,dy:-1},{dx:1,dy:-1}],[{dx:-1,dy:0},{dx:1,dy:0}]],!1);b&&(h(this,K).add(a.index),h(this,K).add(b.index))};
Ga=function(a){var b=[[na[wa[Math.floor(Math.random()*wa.length)]]]];(b=sa(h(this,J),a,b,!1))&&(h(this,K).add(a.index),h(this,K).add(b.index))};Ha=function(a){var b=a.aa;(b=sa(h(this,J),a,b,!0))&&(h(this,K).add(a.index),h(this,K).add(b.index))};
Ia=function(a){for(const b of a){a=b.v.sort((e,k)=>k.position.y-e.position.y);const c=b.F.sort((e,k)=>e.position.y-k.position.y),d=a.length;let f=0;const g=d/4;for(let e=0;e<d;e++){const k=a[e],n=c[e];if(Math.sqrt(k.position.x*n.position.x+k.position.y*n.position.y),k.position.y>n.position.y&&(ta(h(this,J),k,n),h(this,K).add(k.index),h(this,K).add(n.index),f++,f>=g))break}}};
function Oa(a,b){a.g=document.createElement("div");a.g.classList.add("ui-window");a.g.style.left=`${b.x}px`;a.g.style.top=`${b.y}px`;a.g.style.width=`${a.size.width}px`;a.g.style.height=`${a.size.height}px`;a.g.style.maxWidth=`${a.N.width}px`;a.g.style.maxHeight=`${a.N.height}px`;a.V.appendChild(a.g);a.i=document.createElement("div");a.i.classList.add("ui-window__titlebar");b=document.createElement("span");b.classList.add("ui-window__title");b.textContent="Particle Palette";a.i.appendChild(b);a.g.appendChild(a.i);
b=document.createElement("div");b.classList.add("ui-window__controls");a.o=document.createElement("button");a.o.classList.add("ui-window__title-button");const c=document.createElement("img");c.src="./assets/icons/close.svg";a.o.appendChild(c);b.appendChild(a.o);a.i.appendChild(b);a.l=document.createElement("div");a.l.classList.add("ui-window__content-area");a.l.style.flexDirection="row";a.g.appendChild(a.l);a.j=document.createElement("div");a.j.classList.add("ui-window__category-strip","strip-left");
a.l.appendChild(a.j);a.A=document.createElement("div");a.A.classList.add("ui-window__content-container");a.l.appendChild(a.A)}function Pa(a,b){const c=a.m[b];c&&(a.m.forEach(d=>{d.style.display="none"}),c.style.display="",a.G.forEach((d,f)=>{f===b?d.classList.add("active"):d.classList.remove("active")}))}function Qa(a){const b=document.createElement("div");b.classList.add("ui-flex-spacer");a.j.appendChild(b)}
function X(a,b,c,d){let f=a.m.length;a.m.length!==0&&(b.style.display="none");b.id="container-"+f;a.A.appendChild(b);const g=document.createElement("button");g.classList.add("ui-window__category-button");g.title=c;a.j.appendChild(g);const e=document.createElement("img");e.classList.add("ui-window__category-icon");e.alt=c;e.src=d;g.appendChild(e);g.addEventListener("click",()=>Pa(a,f));a.m.length>0&&(a.j.style.display="flex");a.G.push(g);a.m.push(b)}
function Ra(a){a.l.appendChild(a.A);a.l.appendChild(a.j);a.l.style.flexDirection="column";a.j.classList.forEach(b=>{b.startsWith("strip-")&&a.j.classList.remove(b)});a.j.classList.add("ui-window__category-strip","strip-bottom")}
const Ta=class{constructor(a){var b={x:320,y:300};this.G=[];this.m=[];this.C=()=>{Sa++;this.g.style.zIndex=Sa.toString()};this.H=c=>{if(c.stopPropagation(),this.C(),c.button===0){this.i.setPointerCapture(c.pointerId);const d=this.g.getBoundingClientRect();this.B.x=c.clientX-d.left;this.B.y=c.clientY-d.top;this.u=!0}else this.u=!1};this.L=c=>{this.u&&(this.i.releasePointerCapture(c.pointerId),this.u=!1)};this.K=c=>{if(this.u){const d=Math.max(0,Math.min(c.clientY-this.B.y,window.innerHeight-this.g.offsetHeight));
this.g.style.left=`${Math.max(0,Math.min(c.clientX-this.B.x,window.innerWidth-this.g.offsetWidth))}px`;this.g.style.top=`${d}px`}};this.S=()=>{window.removeEventListener("resize",this.M);this.i.removeEventListener("pointerdown",this.H);this.i.removeEventListener("pointermove",this.K);this.i.removeEventListener("pointerup",this.L);this.g.removeEventListener("mousedown",this.C);this.g&&this.g.parentElement&&this.g.parentElement.removeChild(this.g);this.l=this.j=this.o=this.i=this.g=null};this.M=()=>
{const c=this.g.offsetLeft,d=this.g.offsetTop,f=Math.max(0,Math.min(c,Math.max(0,window.innerWidth-this.g.offsetWidth))),g=Math.max(0,Math.min(d,Math.max(0,window.innerHeight-this.g.offsetHeight)));(f!==c||g!==d)&&(this.g.style.left=`${f}px`,this.g.style.top=`${g}px`)};this.T=c=>{c.stopPropagation()};this.V=a;this.title="Particle Palette";this.position=b;this.size={width:250,height:200};this.N={width:420,height:400};this.u=!1;this.B={x:0,y:0};Oa(this,b);this.g.addEventListener("mousedown",this.C);
this.i.addEventListener("pointerdown",this.H);this.i.addEventListener("pointermove",this.K);this.i.addEventListener("pointerup",this.L);this.o.addEventListener("click",this.S);this.o.addEventListener("pointerdown",this.T);window.addEventListener("resize",this.M);this.C()}};var Sa=100;class Ua{constructor(){this.g=document.createElement("div");this.g.classList.add("ui-window__content")}}
function Va(a){const b=a.i;b.addEventListener("pointerdown",a.V);b.addEventListener("pointermove",a.pa);b.addEventListener("pointerup",a.ra);b.addEventListener("pointercancel",a.L);b.addEventListener("lostpointercapture",a.L);b.addEventListener("pointerenter",a.M);b.addEventListener("pointerleave",a.N);b.addEventListener("focus",a.M);b.addEventListener("blur",a.N);b.addEventListener("wheel",a.ya,{passive:!1});a.K.addEventListener("contextmenu",a.ua);window.addEventListener("pointerup",a.S);window.addEventListener("mouseup",
a.S);document.addEventListener("visibilitychange",a.wa)}
function Wa(a,b){var c=new Ta(a.K);Ra(c);var d=document.createElement("div");d.classList.add("particle-palette-container");X(c,d,"Solids","./assets/icons/solid.svg");d=document.createElement("div");d.classList.add("particle-palette-container");X(c,d,"Liquids","./assets/icons/liquid.svg");d=document.createElement("div");d.classList.add("particle-palette-container");X(c,d,"Gases","./assets/icons/gas.svg");d=document.createElement("div");d.classList.add("particle-palette-container");X(c,d,"Sands","./assets/icons/sand.svg");
d=document.createElement("div");d.classList.add("particle-palette-container");X(c,d,"Electronics","./assets/icons/electronics.svg");d=new Ua;Qa(c);X(c,d.g,"Settings","./assets/icons/settings.svg");Pa(c,1);a.u=2;d=c.G;const f=c.m;for(let g=0;g<d.length-1;g++)d[g].addEventListener("click",()=>{for(var e of f){const k=e.querySelector(".selected");k&&k.classList.remove("selected")}(e=f[g])&&(e=e.querySelector(".particle-button"))&&(e.classList.add("selected"),a.A=parseInt(e.dataset.Fa||"-1",10),a.u=parseInt(e.dataset.h||
"-1",10))});c=!1;for(const g in b){const e=b[g];if(!e)continue;d=f[e.h-1];if(!d)continue;const k=e.$,n=e.ca,l=la(B(k))>210?"#323238":"#FFFFFFFF",t=B(l),p=document.createElement("button");p.className="particle-button";p.textContent=e.name;p.style.setProperty("--particle-button-base-color",k);p.style.setProperty("--particle-button-variant-color",n);p.style.color=l;p.style.textShadow=`1px 1px 2px rgba(${t[0]}, ${t[1]}, ${t[2]}, 0.6)`;p.dataset.Fa=e.id.toString();p.dataset.h=e.h.toString();p.addEventListener("click",
()=>{for(const w of f){const x=w.querySelector(".selected");x&&x.classList.remove("selected")}p.classList.add("selected");a.A=e.id;a.u=e.h});d.appendChild(p);!c&&e.h===a.u&&(p.classList.add("selected"),a.A=e.id,c=!0)}}
function La(a,b,c){var d=a.l;const f=[],g=a.B,e=a.C,k=[-1,1];a=(t,p)=>{for(const w of k)for(const x of k){const v=b+t*x,y=c+p*w,r=b+p*x,D=c+t*w;v>=0&&v<g&&y>=0&&y<e&&f.push({index:(e-y)*g+v,value:new Uint8ClampedArray([227,227,227,180])});r>=0&&r<g&&D>=0&&D<e&&f.push({index:(e-D)*g+r,value:new Uint8ClampedArray([227,227,227,180])})}};let n=d,l=0;d-=d;for(a(n,l);l<n;)l++,d<0?d+=2*l+1:(n--,d+=2*(l-n)+1),a(n,l);return f}
class Xa{constructor(a,b,c){this.V=d=>{this.m=d.pointerId;d.button===0?(this.g=!0,this.j=!1):d.button===2?(this.j=!0,this.g=!1):(this.g=!1,this.j=!1);try{this.i.setPointerCapture(d.pointerId)}catch{}const f=this.i.getBoundingClientRect(),g=this.C/f.height;this.o.x=this.B/f.width*(d.clientX-f.left);this.o.y=this.i.height-(d.clientY-f.top)*g};this.ra=d=>{if(this.m===d.pointerId){this.m=null;try{this.i.releasePointerCapture(d.pointerId)}catch{}}this.j=this.g=!1};this.pa=d=>{var f=this.i.getBoundingClientRect();
const g=this.i.height/f.height;if(this.o.x=this.B/f.width*(d.clientX-f.left),this.o.y=this.i.height-(d.clientY-f.top)*g,typeof d.buttons=="number")f=(d.buttons&2)===2,this.g=(d.buttons&1)===1,this.j=f};this.L=d=>{if(this.g=!1,this.j=!1,this.m===d.pointerId){try{this.i.releasePointerCapture(d.pointerId)}catch{}this.m=null}};this.S=()=>{this.j=this.g=!1;this.m=null};this.wa=()=>{document.hidden&&(this.g=!1,this.j=!1,this.m=null)};this.ya=d=>{d.preventDefault();this.T=!0;this.G=d.deltaY};this.ua=d=>
{d.preventDefault()};this.M=()=>{this.H=!0};this.N=()=>{this.H=!1};this.K=b;this.i=c;this.B=z.J;this.C=z.I;this.sa=z.oa;this.ta=z.na;this.A=z.Aa;this.u=z.za;this.l=z.ma;this.m=null;this.j=this.g=!1;this.H=!0;this.T=!1;this.G=0;this.o={x:0,y:0};Va(this);Wa(this,a)}}var R,Ya,S,Y,V,W,Z,Ma,Na,Za;
class $a{constructor(a){m(this,Ma);m(this,R);m(this,Ya);m(this,S);m(this,Y);m(this,V);m(this,W);m(this,Z);q(this,R,!1);q(this,Ya,!1);q(this,S,new Map);q(this,Y,0);q(this,V,0);q(this,W,0);q(this,Z,0);u(this,Ma,Za).call(this,a)}get Da(){return h(this,Ya)}}R=new WeakMap;Ya=new WeakMap;S=new WeakMap;Y=new WeakMap;V=new WeakMap;W=new WeakMap;Z=new WeakMap;Ma=new WeakSet;
Na=function(a,b){const c=a-h(this,Z);c>=1E3&&(q(this,V,h(this,Y)*1E3/c),q(this,W,b.ba*1E3/c),q(this,Y,0),b.ba=0,q(this,Z,a));aa(this,Y).X++};
Za=function(a){var b=document.createElement("div");b.classList.add("debug-container");a.appendChild(b);h(this,S).set("debug-container",b);a=document.createElement("div");a.classList.add("debug-info-container");b.appendChild(a);h(this,S).set("info-container",a);b=document.createElement("div");b.classList.add("debug-info");a.appendChild(b);h(this,S).set("fps",b);b=document.createElement("div");b.classList.add("debug-info");a.appendChild(b);h(this,S).set("tps",b)};
(async function(){try{z.J=Math.max(40,Math.min(400,z.J));z.I=Math.max(40,Math.min(400,z.I));z.W=Math.max(4,Math.min(1E3,z.W));Object.freeze(z);const a=document.getElementById("main-canvas");if(!(a instanceof HTMLCanvasElement))throw Error("HTML element 'main-canvas' does not exist.");const b=document.getElementById("main-panel");if(!(b instanceof HTMLDivElement))throw Error("HTML element 'main-panel' does not exist.");a.style.aspectRatio=(z.J/z.I).toString();const c=new ja(a),d=await ea(),f=new Xa(d,
b,a),g=new $a(b);q(g,R,!0);(new Ka(d,c,f,g)).start();console.log(d)}catch(a){console.error("ERROR: Failed to initialize engine due to data loading failure.",a)}})();

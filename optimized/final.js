var g=(a,b)=>{if(!b.has(a))throw TypeError("Cannot read from private field");return b.get(a)},m=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},p=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot write to private field");b.set(a,c)},u=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot access private method");return c},ca=(a,b)=>({set V(c){p(a,b,c)},get V(){return g(a,b)}});
(function(){function a(c){if(!c.xa){c.xa=!0;var d={};d=(c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d);fetch(c.href,d)}}const b=document.createElement("link").relList;if(!(b&&b.supports&&b.supports("modulepreload"))){for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);(new MutationObserver(c=>
{for(const d of c)if(d.type==="childList")for(const e of d.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&a(e)})).observe(document,{childList:!0,subtree:!0})}})();const z={M:244,L:192,va:10,ua:1,ja:42,ia:4,ka:.02,Da:0,Ca:1,Ga:!0,Fa:!1,sa:16.667,U:25};function da(a){a=[...a];for(let b=a.length-1;b>0;b--){const c=Math.floor(Math.random()*(b+1));[a[b],a[c]]=[a[c],a[b]]}return a}
function ea(a){var b=Math.max(10,Math.min(a,80));const c=b*Math.PI/180;a=[];(a.push([{dx:0,dy:-1}]),b<50)?(a.push([{dx:1,dy:-1},{dx:-1,dy:-1}]),b=Math.round(1/Math.tan(c)),a.push([{dx:b,dy:-1},{dx:b*-1,dy:-1}])):(b=Math.round(Math.tan(c)),a.push([{dx:1,dy:-b},{dx:-1,dy:-b}]));return a}
async function fa(){try{const a=await fetch("./src/data/particles.data");if(!a.ok)throw Error(`HTTP error! Status: ${a.status}`);return await a.text()}catch(a){throw console.error("Failed to read particle data from ./src/data/particles.data:",a),Error("Failed to load particle data.");}}
async function ha(){var a=await fa();let b={};var c=new Set,d=null;for(var e of a.split("\n"))if(a=e.trim(),a.length!==0&&!a.startsWith("#"))if(a.startsWith("[")&&a.endsWith("]"))a=parseInt(a.slice(1,-1),10),isNaN(a)||a<10?d=null:c.has(a)?(console.warn(`[Loader] Duplicate ID found: ${a}. Ignoring.`),d=null):(c.add(a),d=a,b[a]={});else if(d!==null&&(a=a.split(":").map(h=>h.trim()),a.length===2)){const h=a[1],f=b[d];switch(a[0]){case "name":f.name=h;break;case "category":f.h=parseInt(h,10);break;case "base_color":f.aa=
h;break;case "variant_color":f.ga=h;break;case "is_movable":f.ca=h==="true";break;case "density":f.A=parseFloat(h);break;case "max_concentration":f.za=parseInt(h);break;case "repose_angle":f.fa=parseFloat(h)}}c={};for(const h in b)d=b[h],e=parseInt(h,10),d.name===void 0||d.h===void 0||d.aa===void 0||d.ga===void 0||d.ca===void 0||d.A===void 0?console.warn(`[Loader] Corrupted particle block found of ID: ${e}. Missing core properties.`):(a={id:e,name:d.name,W:d.aa,Z:d.ga,O:d.ca,A:d.A},d.h===1?c[e]={...a,
h:1}:d.h===2?c[e]={...a,da:d.za,h:2}:d.h===3?c[e]={...a,h:3}:d.h===4?c[e]={...a,h:4,ea:d.fa,X:ea(d.fa)}:d.h===5&&(c[e]={...a,h:5}));return c[0]={id:0,name:"Empty",h:0,W:"#0E0E11",Z:"#0E0E11",O:!0,A:0},c}var A,B,C,E,F,G,H,I,J,ia,ja,ka;
class la{constructor(a){m(this,J);m(this,A);m(this,B);m(this,C);m(this,E);m(this,F);m(this,G);m(this,H);m(this,I);p(this,A,a);p(this,B,g(this,A).getContext("2d"));p(this,C,z.M);p(this,E,z.L);p(this,F,new Uint8ClampedArray(g(this,C)*g(this,E)*4));p(this,G,[]);p(this,H,[]);p(this,I,[]);g(this,A).width=g(this,C);g(this,A).height=g(this,E);g(this,B).imageSmoothingEnabled=!1;g(this,B).translate(0,g(this,A).height);g(this,B).scale(1,-1)}}A=new WeakMap;B=new WeakMap;C=new WeakMap;E=new WeakMap;F=new WeakMap;
G=new WeakMap;H=new WeakMap;I=new WeakMap;J=new WeakSet;ia=function(){var a=g(this,G);const b=g(this,C),c=g(this,E);for(const d of a){a=(c-1-d.position.y)*b+d.position.x;let e=u(this,J,ja).call(this,d);g(this,F)[a*4]=e[0];g(this,F)[a*4+1]=e[1];g(this,F)[a*4+2]=e[2];g(this,F)[a*4+3]=e[3]}};ja=function(a){return a.color};
ka=function(a,b){for(const {index:d,value:e}of b){var c=e[3];b=c/255;const h=Math.round(e[1]*b+a[d*4+1]*(1-b)),f=Math.round(e[2]*b+a[d*4+2]*(1-b));c=Math.min(a[d*4+3],c);a[d*4]=Math.round(e[0]*b+a[d*4]*(1-b));a[d*4+1]=h;a[d*4+2]=f;a[d*4+3]=c}};
const ma=Object.freeze({Sa:new Uint8ClampedArray([255,255,255,255]),$:new Uint8ClampedArray([0,0,0,255]),Ka:new Uint8ClampedArray([128,128,128,255]),RED:new Uint8ClampedArray([255,0,0,255]),La:new Uint8ClampedArray([0,255,0,255]),Ba:new Uint8ClampedArray([0,0,255,255]),Ta:new Uint8ClampedArray([255,255,0,255]),Ea:new Uint8ClampedArray([0,255,255,255]),Ma:new Uint8ClampedArray([255,0,255,255]),Pa:new Uint8ClampedArray([0,0,0,0]),Oa:new Uint8ClampedArray([255,255,255,128])});
function na(a){if(a==null)return ma.$;a=a.replace("#","");if(a.length===6)a+="FF";else if(a.length===3){let c="";for(var b of a)c+=b,c+=b;a=c+"FF"}else return ma.$;b=parseInt(a,16);return new Uint8ClampedArray([b>>24&255,b>>16&255,b>>8&255,b&255])}function oa(a){return.299*a[0]+.587*a[1]+.114*a[2]}
const pa=Object.freeze({ha:[{dx:-1,dy:1},{dx:0,dy:1},{dx:1,dy:1},{dx:-1,dy:0},{dx:1,dy:0},{dx:-1,dy:-1},{dx:0,dy:-1},{dx:1,dy:-1}]}),qa=Object.freeze({Qa:{dx:-1,dy:1},wa:{dx:0,dy:1},Ra:{dx:1,dy:1},la:{dx:-1,dy:0},Na:{dx:1,dy:0},Ia:{dx:-1,dy:-1},Ha:{dx:0,dy:-1},Ja:{dx:1,dy:-1}});var K,L,M,ra,sa;function N(a,b){g(a,L).add(b.index);b=ta(a,b);for(const c of b)g(a,L).add(c.index)}function ua(a,b,c){return b>=0&&b<a.width&&c>=0&&c<a.height?g(a,K)[c*a.width+b]:null}
function va(a,b,c,d=!1){for(var e of c)if(e){c=da(e);for(const h of c)if(c=h.dx,d&&Math.random()>.5&&(c=h.dx*-1),(c=ua(a,b.position.x+c,b.position.y+h.dy))&&c.O&&b.A>c.A)return g(a,K)[c.index]=b,g(a,K)[b.index]=c,d={x:b.position.x,y:b.position.y},e=b.index,b.position=c.position,b.index=c.index,c.position=d,c.index=e,N(a,b),N(a,c),c}return null}
function wa(a,b,c){g(a,K)[b.index]=c;g(a,K)[c.index]=b;const d={x:b.position.x,y:b.position.y},e=b.index;b.position=c.position;b.index=c.index;c.position=d;c.index=e;N(a,b);N(a,c)}function xa(a,b,c){return ua(a,b.position.x+c.dx,b.position.y+c.dy)}function ta(a,b){return pa.ha.map(c=>xa(a,b,c)).filter(c=>c!==null).filter(()=>!0)}
class ya{constructor(a,b,c){m(this,M);m(this,K);m(this,L);this.width=a;this.height=b;p(this,K,Array(a*b));p(this,L,new Set);this.qa=c;u(this,M,sa).call(this,0)}get data(){return g(this,K)}get ba(){return g(this,L)}}K=new WeakMap;L=new WeakMap;M=new WeakSet;
ra=function(a){a=this.qa[a];if(!a)return null;var b=Math.round(Math.random()*5)/5;const c=na(a.W),d=na(a.Z);b=new Uint8ClampedArray([c[0]+(d[0]-c[0])*b,c[1]+(d[1]-c[1])*b,c[2]+(d[2]-c[2])*b,c[3]+(d[3]-c[3])*b]);b={handle:-1,id:a.id,name:a.name,color:b,position:{x:-1,y:-1},index:0,O:a.O,A:a.A};return a.h===0?{...b,h:0}:a.h===1?{...b,h:1}:a.h===2?{...b,h:2,Ua:0,da:a.da}:a.h===3?{...b,h:3}:a.h===4?{...b,h:4,ea:a.ea,X:a.X}:a.h===5?{...b,h:5,node:-1}:null};
sa=function(a){const b=this.width,c=this.height;p(this,K,Array(b*c));for(let d=0;d<c;d++)for(let e=0;e<b;e++){let h=d*b+e,f=u(this,M,ra).call(this,a);f&&(f.position.x=e,f.position.y=d,f.index=h,g(this,K)[h]=f,g(this,L).add(f.index))}};const za=Object.keys(qa);var O,Aa,P,Ba,Ca,Q,R,S,Da,Ea,T,U,V,W,Fa,Ga,X,Ha,Ia,Ja,Ka,La;
function Ma(a){const b=a.width;var c=a.height;const d=[],e=[],h={};for(--c;c>=0;c--)for(let t=0;t<b;t++){var f=c*b+t,k=ua(a,t,c);if(!k||k.h!==2||k.h!==2)continue;const q=xa(a,k,qa.wa);var n=xa(a,k,qa.la),l=q&&q.id===k.id;const w=n&&n.id===k.id;let x=-1;w&&(x=c*b+(t-1));let v=-1;l&&(v=(c+1)*b+t);n=q&&q.id===0;if(w||l)if(w&&!l)l=h[x],d[l].push(f),n&&(e[l].u.push(k),e[l].B.push(q)),h[f]=l;else if(!w&&l)l=h[v],d[l].push(f),n&&(e[l].u.push(k),e[l].B.push(q)),h[f]=l;else{if(l=h[v],d[l].push(f),n&&(e[l].u.push(k),
e[l].B.push(q)),h[f]=l,f=h[x],f!==l){k=e[f];for(const y of k.u)e[l].u.push(y);for(const y of k.B)e[l].B.push(y);k=d[f];for(const y of k)h[y]=l;d[f]=[];e[f]={u:[],B:[]}}}else l=e.length,d.push([f]),e.push({u:[],B:[]}),n&&(e[l].u.push(k),e[l].B.push(q)),h[f]=l}return e.filter(t=>t.u.length>30)}
class Na{constructor(a,b,c,d){m(this,X);m(this,O);m(this,Aa);m(this,P);m(this,Ba);m(this,Ca);m(this,Q);m(this,R);m(this,S);m(this,Da);m(this,Ea);m(this,T);m(this,U);m(this,V);m(this,W,0);m(this,Fa,60);m(this,Ga,e=>{if(g(this,S)){if(g(this,U)){var h=e-g(this,U);p(this,U,e);var f=g(this,Aa),k=g(this,Q),n=g(this,O),l=Math.floor(f.o.x),t=Math.floor(f.o.y);if(f.H){var q=Oa(f,l,t);p(n,I,[]);p(n,I,q)}if(f.g||f.j)if(n=t<f.F+f.l&&t>=0-f.l,l<f.D+f.l&&l>=0-f.l&&n){--t;n=f.l;q=f.g?f.C:0;for(let aa=-n;aa<=n;aa++)for(let ba=
-n;ba<=n;ba++)if(!(aa*aa+ba*ba>n*n)){var w=l+aa,x=t+ba;if(w>=0&&w<k.width&&x>=0&&x<k.height){var v=ua(k,w,x);if(q===0||v===null||v.id===0){v=k;var y=q;w>=0&&w<v.width&&x>=0&&x<v.height&&(y=u(v,M,ra).call(v,y),y.position.x=w,y.position.y=x,y.index=x*v.width+w,N(v,y),g(v,K)[x*v.width+w]=y)}}}}f.N&&(k=f.l-f.G*f.T,k=Math.floor(k),k=Math.min(f.ma,k),k=Math.max(0,k),f.l=k,f.G=0);p(this,V,g(this,V)+h);for(h=0;g(this,V)>=g(this,T);){k=[];for(var r of g(this,Q).ba)k.push(g(this,Q).data[r]);ca(this,W).V++;
g(this,W)>g(this,Fa)&&(g(this,Q).ba.clear(),p(this,W,0));t=new Uint8ClampedArray([210,55,55,180]);f=g(this,O);l=k;t=g(this,P).ya?t:void 0;if(g(f,G).push(...l),t){n=g(f,C);q=g(f,E);for(var D of l)l=(q-1-D.position.y)*n+D.position.x,g(f,H).push({index:l,value:t})}u(this,X,Ha).call(this,k);this.Y++;p(this,V,g(this,V)-g(this,T));h++;h>60&&p(this,V,0)}r=g(this,O);u(r,J,ia).call(r);D=new Uint8ClampedArray(g(r,F));u(r,J,ka).call(r,D,g(r,H));u(r,J,ka).call(r,D,g(r,I));D=new ImageData(D,g(r,C),g(r,E));g(r,
B).putImageData(D,0,0);g(r,G).length=0;p(r,H,[]);r=g(this,P);g(r,Pa)&&(u(r,Qa,Ra).call(r,e,this),(e=g(r,Y).get("fps"))&&(e.textContent=`FPS: ${g(r,Sa).toFixed(2)}`),(e=g(r,Y).get("tps"))&&(e.textContent=`TPS: ${g(r,Ta).toFixed(2)}`))}else p(this,U,e);p(this,Da,requestAnimationFrame(g(this,Ga)))}});p(this,O,b);p(this,Aa,c);p(this,P,d);p(this,Ba,z.M);p(this,Ca,z.L);p(this,Q,new ya(g(this,Ba),g(this,Ca),a));p(this,R,new Set);p(this,S,!1);p(this,Da,null);p(this,Ea,z.sa);p(this,T,z.U);p(this,U,null);p(this,
V,0);this.Y=0}start(){g(this,S)||(p(this,S,!0),g(this,Ga).call(this,0))}}O=new WeakMap;Aa=new WeakMap;P=new WeakMap;Ba=new WeakMap;Ca=new WeakMap;Q=new WeakMap;R=new WeakMap;S=new WeakMap;Da=new WeakMap;Ea=new WeakMap;T=new WeakMap;U=new WeakMap;V=new WeakMap;W=new WeakMap;Fa=new WeakMap;Ga=new WeakMap;X=new WeakSet;
Ha=function(a){g(this,R).clear();a=da(a);a.sort((b,c)=>b.position.y-c.position.y);for(const b of a)if(b&&!g(this,R).has(b.index))switch(b.h){case 2:u(this,X,Ia).call(this,b);break;case 3:u(this,X,Ja).call(this,b);break;case 4:u(this,X,Ka).call(this,b)}a=Ma(g(this,Q));u(this,X,La).call(this,a)};Ia=function(a){const b=va(g(this,Q),a,[[{dx:0,dy:-1}],[{dx:-1,dy:-1},{dx:1,dy:-1}],[{dx:-1,dy:0},{dx:1,dy:0}]],!1);b&&(g(this,R).add(a.index),g(this,R).add(b.index))};
Ja=function(a){var b=[[qa[za[Math.floor(Math.random()*za.length)]]]];(b=va(g(this,Q),a,b,!1))&&(g(this,R).add(a.index),g(this,R).add(b.index))};Ka=function(a){var b=a.X;(b=va(g(this,Q),a,b,!0))&&(g(this,R).add(a.index),g(this,R).add(b.index))};
La=function(a){for(const b of a){a=b.u.sort((f,k)=>k.position.y-f.position.y);const c=b.B.sort((f,k)=>f.position.y-k.position.y),d=a.length;let e=0;const h=d/4;for(let f=0;f<d;f++){const k=a[f],n=c[f];if(Math.sqrt(k.position.x*n.position.x+k.position.y*n.position.y),k.position.y>n.position.y&&(wa(g(this,Q),k,n),g(this,R).add(k.index),g(this,R).add(n.index),e++,e>=h))break}}};
function Ua(a,b){var c=document.createElement("div");c.classList.add("ui-window");a.T.appendChild(c);a.g=c;a.g.style.left="320px";a.g.style.top="300px";a.g.style.width=`${a.K.width}px`;a.g.style.height=`${a.K.height}px`;a.g.style.maxWidth=`${a.I.width}px`;a.g.style.maxHeight=`${a.I.height}px`;c=document.createElement("div");c.classList.add("ui-window__titlebar");a.g.appendChild(c);a.i=c;var d=document.createElement("span");d.classList.add("ui-window__title");d.textContent="Particle Palette";c.appendChild(d);
c=document.createElement("div");c.classList.add("ui-window__controls");a.i.appendChild(c);d=document.createElement("button");d.classList.add("ui-window__title-button");var e=document.createElement("img");e.src="./assets/icons/close.svg";d.appendChild(e);c.appendChild(d);a.H=d;d=document.createElement("div");d.classList.add("ui-window__content-area");d.style.flexDirection="column";a.g.appendChild(d);e=document.createElement("div");e.classList.add("ui-window__category-strip","strip-bottom");a.m=e;c=
document.createElement("div");c.classList.add("ui-window__content-container");a.N=c;d.appendChild(c);d.appendChild(e);d=null;b?d=b:(d=document.createElement("div"),d.classList.add("ui-window__content"));d.id="container-0";c.appendChild(d);a.j.push(d);Va(a,"Solids","./assets/icons/solid.svg",0)}
function Va(a,b,c,d){const e=document.createElement("button");e.classList.add("ui-window__category-button");const h=document.createElement("img");h.alt=b;h.src=c;e.title=b;h.classList.add("ui-window__category-icon");e.appendChild(h);a.G.push(e);a.m.appendChild(e);e.addEventListener("click",()=>Wa(a,d))}
function Wa(a,b){a.j.forEach((c,d)=>{c.style.display=d===b?"":"none"});a.m.querySelectorAll(".ui-window__category-button").forEach((c,d)=>{d===b?c.classList.add("active"):c.classList.remove("active")})}function Xa(a,b,c,d){let e=a.j.length,h=null;d?h=d:(h=document.createElement("div"),h.classList.add("ui-window__content"));h.id="container-"+e;h.style.display="none";a.N.appendChild(h);a.j.push(h);Va(a,b,c,e);a.m.style.display="flex"}
function Ya(a){const b=document.createElement("div");b.classList.add("ui-flex-spacer");a.m.appendChild(b)}
const $a=class{constructor(a,b){var c={width:250,height:200},d={width:420,height:400};this.j=[];this.G=[];this.v=()=>{Za++;this.g.style.zIndex=Za.toString()};this.C=e=>{if(e.stopPropagation(),this.v(),e.button===0){this.i.setPointerCapture(e.pointerId);const h=this.g.getBoundingClientRect();this.o.x=e.clientX-h.left;this.o.y=e.clientY-h.top;this.l=!0}else this.l=!1};this.F=e=>{this.l&&(this.i.releasePointerCapture(e.pointerId),this.l=!1)};this.D=e=>{if(this.l){const h=Math.max(0,Math.min(e.clientY-
this.o.y,window.innerHeight-this.g.offsetHeight));this.g.style.left=`${Math.max(0,Math.min(e.clientX-this.o.x,window.innerWidth-this.g.offsetWidth))}px`;this.g.style.top=`${h}px`}};this.R=()=>{window.removeEventListener("resize",this.J);this.i.removeEventListener("pointerdown",this.C);this.i.removeEventListener("pointermove",this.D);this.i.removeEventListener("pointerup",this.F);this.g.removeEventListener("mousedown",this.v);this.g&&this.g.parentElement&&this.g.parentElement.removeChild(this.g)};
this.J=()=>{const e=Math.max(0,window.innerWidth-this.g.offsetWidth),h=Math.max(0,window.innerHeight-this.g.offsetHeight),f=this.g.offsetLeft,k=this.g.offsetTop;let n=f,l=k;f>e?n=e:f<0&&(n=0);k>h?l=h:k<0&&(l=0);(n!==f||l!==k)&&(this.g.style.left=`${n}px`,this.g.style.top=`${l}px`)};this.S=e=>{e.stopPropagation()};this.P=e=>{document.querySelectorAll(".dropdown-list.is-open").forEach(h=>{const f=h.closest(".custom-dropdown-container");f&&!f.contains(e.target)&&h.classList.remove("is-open")})};this.T=
a;c.width=Math.max(40,Math.min(c.width,d.width));c.height=Math.max(40,Math.min(c.height,d.height));this.K=c;this.I=d;this.l=!1;this.o={x:0,y:0};Ua(this,b);this.g.addEventListener("mousedown",this.v);this.i.addEventListener("pointerdown",this.C);this.i.addEventListener("pointermove",this.D);this.i.addEventListener("pointerup",this.F);this.H.addEventListener("click",this.R);this.H.addEventListener("pointerdown",this.S);window.addEventListener("resize",this.J);this.v();document.addEventListener("click",
this.P)}};var Za;Za=100;
function ab(a){const b=a.i;b.addEventListener("pointerdown",a.P);b.addEventListener("pointermove",a.R);b.addEventListener("pointerup",a.S);b.addEventListener("pointercancel",a.J);b.addEventListener("lostpointercapture",a.J);b.addEventListener("pointerenter",a.oa);b.addEventListener("pointerleave",a.pa);b.addEventListener("wheel",a.ta,{passive:!1});a.I.addEventListener("contextmenu",a.na);window.addEventListener("pointerup",a.K);window.addEventListener("mouseup",a.K);document.addEventListener("visibilitychange",a.ra)}
function bb(a,b){var c=document.createElement("div");c.classList.add("particle-palette-container");c=new $a(a.I,c);var d=document.createElement("div");d.classList.add("particle-palette-container");Xa(c,"Liquids","./assets/icons/liquid.svg",d);d=document.createElement("div");d.classList.add("particle-palette-container");Xa(c,"Gases","./assets/icons/gas.svg",d);d=document.createElement("div");d.classList.add("particle-palette-container");Xa(c,"Sands","./assets/icons/sand.svg",d);d=document.createElement("div");
d.classList.add("particle-palette-container");Xa(c,"Electronics","./assets/icons/electronics.svg",d);Ya(c);Xa(c,"Settings","./assets/icons/settings.svg");Wa(c,1);a.v=2;const e=c.j;c=c.G;for(let h=0;h<c.length-1;h++)c[h].addEventListener("click",()=>{for(var f of e){const k=f.querySelector(".selected");k&&k.classList.remove("selected")}(f=e[h])&&(f=f.querySelector(".particle-button"))&&(f.classList.add("selected"),a.C=parseInt(f.dataset.Aa||"-1",10),a.v=parseInt(f.dataset.h||"-1",10))});c=!1;for(const h in b){const f=
b[h];if(!f)continue;d=e[f.h-1];if(!d)continue;const k=f.W,n=f.Z,l=oa(na(k))>210?"#323238":"#FFFFFFFF",t=na(l),q=document.createElement("button");q.className="particle-button";q.textContent=f.name;q.style.setProperty("--particle-button-base-color",k);q.style.setProperty("--particle-button-variant-color",n);q.style.color=l;q.style.textShadow=`1px 1px 2px rgba(${t[0]}, ${t[1]}, ${t[2]}, 0.6)`;q.dataset.Aa=f.id.toString();q.dataset.h=f.h.toString();q.addEventListener("click",()=>{for(const w of e){const x=
w.querySelector(".selected");x&&x.classList.remove("selected")}q.classList.add("selected");a.C=f.id;a.v=f.h});d.appendChild(q);!c&&f.h===a.v&&(q.classList.add("selected"),a.C=f.id,c=!0)}}
function Oa(a,b,c){var d=a.l;const e=[],h=a.D,f=a.F,k=[-1,1];a=(t,q)=>{for(const w of k)for(const x of k){const v=b+t*x,y=c+q*w,r=b+q*x,D=c+t*w;v>=0&&v<h&&y>=0&&y<f&&e.push({index:(f-y)*h+v,value:new Uint8ClampedArray([227,227,227,180])});r>=0&&r<h&&D>=0&&D<f&&e.push({index:(f-D)*h+r,value:new Uint8ClampedArray([227,227,227,180])})}};let n=d,l=0;d-=d;for(a(n,l);l<n;)l++,d<0?d+=2*l+1:(n--,d+=2*(l-n)+1),a(n,l);return e}
class cb{constructor(a,b,c){this.P=d=>{this.m=d.pointerId;d.button===0?(this.g=!0,this.j=!1):d.button===2?(this.j=!0,this.g=!1):(this.g=!1,this.j=!1);try{this.i.setPointerCapture(d.pointerId)}catch{}const e=this.i.getBoundingClientRect(),h=this.F/e.height;this.o.x=this.D/e.width*(d.clientX-e.left);this.o.y=this.i.height-(d.clientY-e.top)*h};this.S=d=>{if(this.m===d.pointerId){this.m=null;try{this.i.releasePointerCapture(d.pointerId)}catch{}}this.j=this.g=!1};this.R=d=>{var e=this.i.getBoundingClientRect();
const h=this.i.height/e.height;if(this.o.x=this.D/e.width*(d.clientX-e.left),this.o.y=this.i.height-(d.clientY-e.top)*h,typeof d.buttons=="number")e=(d.buttons&2)===2,this.g=(d.buttons&1)===1,this.j=e};this.J=d=>{if(this.g=!1,this.j=!1,this.m===d.pointerId){try{this.i.releasePointerCapture(d.pointerId)}catch{}this.m=null}};this.K=()=>{this.j=this.g=!1;this.m=null};this.ra=()=>{document.hidden&&(this.g=!1,this.j=!1,this.m=null)};this.ta=d=>{d.preventDefault();this.N=!0;this.G=d.deltaY};this.na=d=>
{d.preventDefault()};this.oa=()=>{this.H=!0};this.pa=()=>{this.H=!1};this.I=b;this.i=c;this.D=z.M;this.F=z.L;this.T=z.ka;this.ma=z.ja;this.C=z.va;this.v=z.ua;this.l=z.ia;this.m=null;this.j=this.g=!1;this.H=!0;this.N=!1;this.G=0;this.o={x:0,y:0};ab(this);bb(this,a)}}var Pa,db,Y,Z,Sa,Ta,eb,Qa,Ra,fb;
class gb{constructor(a){m(this,Qa);m(this,Pa);m(this,db);m(this,Y);m(this,Z);m(this,Sa);m(this,Ta);m(this,eb);p(this,Pa,!1);p(this,db,!1);p(this,Y,new Map);p(this,Z,0);p(this,Sa,0);p(this,Ta,0);p(this,eb,0);u(this,Qa,fb).call(this,a)}get ya(){return g(this,db)}}Pa=new WeakMap;db=new WeakMap;Y=new WeakMap;Z=new WeakMap;Sa=new WeakMap;Ta=new WeakMap;eb=new WeakMap;Qa=new WeakSet;
Ra=function(a,b){const c=a-g(this,eb);c>=1E3&&(p(this,Sa,g(this,Z)*1E3/c),p(this,Ta,b.Y*1E3/c),p(this,Z,0),b.Y=0,p(this,eb,a));ca(this,Z).V++};
fb=function(a){var b=document.createElement("div");b.classList.add("debug-container");a.appendChild(b);g(this,Y).set("debug-container",b);a=document.createElement("div");a.classList.add("debug-info-container");b.appendChild(a);g(this,Y).set("info-container",a);b=document.createElement("div");b.classList.add("debug-info");a.appendChild(b);g(this,Y).set("fps",b);b=document.createElement("div");b.classList.add("debug-info");a.appendChild(b);g(this,Y).set("tps",b)};
(async function(){try{z.M=Math.max(40,Math.min(400,z.M));z.L=Math.max(40,Math.min(400,z.L));z.U=Math.max(4,Math.min(1E3,z.U));Object.freeze(z);const a=document.getElementById("main-canvas");if(!(a instanceof HTMLCanvasElement))throw Error("HTML element 'main-canvas' does not exist.");const b=document.getElementById("main-panel");if(!(b instanceof HTMLDivElement))throw Error("HTML element 'main-panel' does not exist.");const c=new la(a),d=await ha(),e=new cb(d,b,a),h=new gb(b);p(h,Pa,!0);(new Na(d,
c,e,h)).start();console.log(d)}catch(a){console.error("ERROR: Failed to initialize engine due to data loading failure.",a)}})();
